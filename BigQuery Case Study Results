/* How many times each user wore the tracker*/
SELECT
  Id, COUNT (Id) AS Total_Id
FROM
  `bellabeat-case-study-394315.Daily.Daily_Activity`
GROUP BY 
  Id
ORDER BY
  Total_Id DESC;

/*Creating Active, Moderate, and Light Users */
(SELECT 
  Id, 
  COUNT(Id) AS Total_Logged_Uses,
CASE
  WHEN COUNT (Id) BETWEEN 25 AND 31 THEN 'Active User'
  WHEN COUNT (Id) BETWEEN 15 AND 24 THEN 'Moderate User'
  WHEN COUNT (Id) BETWEEN 0 AND 14 THEN 'Light User'
END as Usage_Type
FROM
  `bellabeat-case-study-394315.Daily.Daily_Activity`
GROUP BY
  Id
ORDER BY
  Total_Logged_Uses);


/* Look more closely at MIN, MAX, and AVG of total steps, total distance, calories and activity levels by ID */ 
SELECT
  Id,
  MIN(TotalSteps) AS Min_Total_Steps,
  MAX(TotalSteps) AS Max_Total_Steps, 
  AVG(TotalSteps) AS Avg_Total_Stpes,
  MIN(TotalDistance) AS Min_Total_Distance, 
  MAX(TotalDistance) AS Max_Total_Distance, 
  AVG(TotalDistance) AS Avg_Total_Distance,
  MIN(Calories) AS Min_Total_Calories,
  MAX(Calories) AS Max_Total_Calories,
  AVG(Calories) AS Avg_Total_Calories,
  MIN(VeryActiveMinutes) AS Min_Very_Active_Minutes,
  MAX(VeryActiveMinutes) AS Max_Very_Active_Minutes,
  AVG(VeryActiveMinutes) AS Avg_Very_Active_Minutes,
  MIN(FairlyActiveMinutes) AS Min_Fairly_Active_Minutes,
  MAX(FairlyActiveMinutes) AS Max_Fairly_Active_Minutes,
  AVG(FairlyActiveMinutes) AS Avg_Fairly_Active_Minutes,
  MIN(LightlyActiveMinutes) AS Min_Lightly_Active_Minutes,
  MAX(LightlyActiveMinutes) AS Max_Lightly_Active_Minutes,
  AVG(LightlyActiveMinutes) AS Avg_Lightly_Active_Minutes,
  MIN(SedentaryMinutes) AS Min_Sedentary_Minutes,
  MAX(SedentaryMinutes) AS Max_Sedentary_Minutes,
  AVG(SedentaryMinutes) AS Avg_Sedentary_Minutes
FROM
  `bellabeat-case-study-394315.Daily.Daily_Activity`
GROUP BY
  Id;

/* View just the averages of different types of minutes by ID */

SELECT 
  Id, 
  avg(VeryActiveMinutes) AS Avg_Very_Active_Minutes,
  avg(FairlyActiveMinutes) AS Avg_Fairly_Active_Minutes,
  avg(LightlyActiveMinutes) AS Avg_Lightly_Active_Minutes,
  avg(SedentaryMinutes) AS Avg_Sedentary_Minutes,
FROM 
  `bellabeat-case-study-394315.Daily.Daily_Activity`
GROUP BY
  Id;

/* Average number of active minutes per day */
SELECT ActivityDay,
ROUND (avg(VeryActiveMinutes), 2) AS Avg_Very_Active_Minutes,
ROUND (avg(FairlyActiveMinutes), 2) AS Avg_Fairly_Active_Minutes,
ROUND (avg(LightlyActiveMinutes), 2) AS Avg_Lightly_Active_Minutes,
ROUND (avg(SedentaryMinutes), 2) AS Avg_Sedentary_Minutes,
FROM  `bellabeat-case-study-394315.Daily.Daily_Activity`
GROUP BY ActivityDay;

/* Average steps, distance, and calories burned per day*/
SELECT  
  Id,  
  AVG(TotalSteps) AS Avg_Total_Steps,
  AVG(TotalDistance) AS Avg_Total_Distance,
  AVG(Calories) AS Avg_Calories_Burned
FROM
  `bellabeat-case-study-394315.Daily.Daily_Activity`
GROUP BY
  Id;

/*How does sleep compare to total steps and calories*/

SELECT
  Activity.Id,
  AVG(Activity.TotalSteps) AS Avg_Total_Steps,
  AVG(Activity.Calories) AS Avg_Calories,
  AVG(Sleep.TotalMinutesAsleep) AS Avg_Total_Minutes_Asleep,
FROM
  `bellabeat-case-study-394315.Daily.Daily_Activity` AS Activity
JOIN
  `bellabeat-case-study-394315.Daily.Daily_Sleep` AS Sleep
ON
  Activity.Id = Sleep.Id
GROUP BY
  Activity.Id;

  
